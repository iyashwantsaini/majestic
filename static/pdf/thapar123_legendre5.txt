
23 11

Article 11.3.2
Journal of Integer Sequences, Vol. 14 (2011),2

3

6

1

47

On the Permutations Generated by

Cyclic Shift

Stéphane Legendre
Team of Mathematical Eco-Evolution

Ecole Normale Supérieure
75005 Paris

France
legendre@ens.fr

Philippe Paclet
Lycée Chateaubriand

00161 Roma
Italy

paclet@dada.it

Abstract

The set of permutations generated by cyclic shift is studied using a number system

coding for these permutations. The system allows to find the rank of a permutation

given how it has been generated, and to determine a permutation given its rank. It

defines a code describing structural and symmetry properties of the set of permuta-

tions ordered according to generation by cyclic shift. The code is associated with an

Hamiltonian cycle in a regular weighted digraph. This Hamiltonian cycle is conjec-

tured to be of minimal weight, leading to a combinatorial Gray code listing the set of

permutations.

1 Introduction

It is well known that any natural integer a can be written uniquely in the factorial number
system

a =
n−1
∑

i=1

ai i!, ai ∈ {0, . . . , i},

1

<div class="annotation"><a href="mailto:legendre@ens.fr">mailto:legendre@ens.fr</a>
<div class="annotation"><a href="mailto:paclet@dada.it">mailto:paclet@dada.it</a>

 
 page_ended 
 
where the uniqueness of the representation comes from the identity

n−1
∑

i=1

i · i! = n! − 1. (1)

Charles-Ange Laisant showed in 1888 [2] that the factorial number system codes the
permutations generated in lexicographic order. More precisely, when the set of permutations
is ordered lexicographically, the rank of a permutation written in the factorial number system
provides a code determining the permutation. The code specifies which interchanges of the
symbols according to lexicographic order have to be performed to generate the permutation.

In this study, a lesser-known number system on the finite ring Zn! is used to describe
properties of the set Sn of permutations on n symbols generated by cyclic shift. When Sn
is ordered according to generation by cyclic shift, the rank of a permutation written in this
number system entirely specifies how the permutation is generated.

This number system is a special case of a large class of methods presented by Knuth [1,
§7.2.1.2] for generating Sn. Here, an explicit and self-contained description is given.

Example 1. As will be shown, any number α in Z5! can be written uniquely

α = α3̟5,3 + α2̟5,2 + α1̟5,1 + α0̟5,0

with the digits
α3 ∈ Z2, α2 ∈ Z3, α1 ∈ Z4, α0 ∈ Z5,

and the base elements

̟5,3 = 3 · 4 · 5 = 60, ̟5,2 = 4 · 5 = 20, ̟5,1 = 5, ̟5,0 = 1.

For example,
84 = 1 · 60 + 1 · 20 + 0 · 5 + 4 · 1 = 1104̟.

We use the digits of 1104̟ to generate by cyclic shift a permutation on 5 symbols. The
generation scheme is

(1)
α3=1
−−−→ (21)

α2=1
−−−→ (132)

α1=0
−−−→ (1324)

α0=4
−−−→ (51324),

and is established as follows. The orbit of the permutation (1) under cyclic shift is

0 : (12)
1 : (21).

We select the permutation (21) whose exponent of the cyclic shift is the leftmost digit α3 = 1.
Next, the orbit of (21) under cyclic shift is

0 : (213)
1 : (132)

2 : (321).

2


 
 page_ended 
 
The digit α2 = 1 leads to (132). Next, the orbit of (132) under cyclic shift is

0 : (1324)

1 : (3241)
2 : (2413)
3 : (4132).

The digit α1 = 0 leads to (1324). Finally, the last digit α0 = 4 leads to (51324). This
permutation has rank 1104̟ = 84 in the set of permutations on 5 symbols generated by
cyclic shift, indexed from 0.

We shall describe properties of Sn generated by cyclic shift:

1. A decomposition into k-orbits;

2. The symmetries;

3. An infinite family of regular digraphs associated with {Sn; n ≥ 1};

4. A conjectured combinatorial Gray code generating the permutations on n symbols. The
adjacency rule associated with this code is that the last symbols of each permutation
match the first symbols of the next optimally.

2 Number system

For any positive integer a, the ring (Z/aZ, +,×) of integers modulo a is denoted Za. The
set Za is identified with a subset of the set N of natural integers.

Proposition 2. For n ≥ 2, any element α ∈ Zn! can be uniquely represented as

α =
n−2
∑

i=0

αi̟n,i, αi ∈ Zn−i,

with the base elements

̟n,0 = 1, ̟n,i = n(n − 1) · · · (n − i + 1), i = 1, . . . , n − 2.

The αi’s are the digits of α in this number system, which we call the ̟-system for short.
Any element of Zn! can be written uniquely

α = αn−2 · · ·α1α0̟.

Unless αn−2 = 1, the leftmost digits are set to 0, so that the representation always involves
n − 1 elements, indexed 0, . . . , n − 2.

3


 
 page_ended 
 
Proof. For simplicity, we momentarily denote ̟i = ̟n,i. For n = 2, there is a single base
element, ̟0 = 1, and the result clearly holds. For n ≥ 3, and α ∈ Zn!, we set

α(0) = α,

αi = α
(i) mod (n − i), α(i+1) = α(i) div (n − i), i = 0, . . . , n − 2,

where div denotes integer division. These relations imply

α(i) = (n − i)α(i+1) + αi, i = 0, . . . , n − 2.

We multiply by ̟i on both sides. For i = 0, . . . , n − 3, we use the identity

̟i+1 = (n − i)̟i, (2)

and for i = n − 2, we use the identity 2̟n−2 = 0 in Z2, to get

̟iα
(i) − ̟i+1α

(i+1) = αi̟i, i = 0, . . . , n − 3,
̟n−2α

(n−2) = αn−2̟n−2.

Adding these relations together, and accounting for telescoping cancellation on the left side,

̟0α
(0) = αn−2̟n−2 + · · · + α0̟0.

As and α(0) = α, we obtain the representation

α = αn−2̟n−2 + · · · + α0̟0.

By construction, αi ∈ Zn−i for i = 0, . . . , n − 2. The existence of the decomposition also
holds in N.

We now prove the uniqueness of the decomposition in N, and momentarily introduce the
element ̟n−1 = n!. In N, the identities

k−1
∑

i=0

(n − i − 1)̟i = ̟k − 1, k ∈ {1, . . . n − 1} (3)

are easily shown using induction and (2) (such identities are general to mixed radix num-
ber systems). Assume that α ∈ N has two different decompositions. Then, with obvious
notations,

n−2
∑

i=0

(αi − α
′

i)̟i = 0. (4)

Let k be the largest index such that αi 6= α
′

i. If k = 0, then α0 6= α
′

0 and αi = α
′

i for i &gt; 0.
From (4) we deduce α0 = α

′

0, a contradiction. If k &gt; 0, then

k−1
∑

i=0

(αi − α
′

i)̟i = (α
′

k − αk)̟k. (5)

We may assume α′k &gt; αk with no loss of generality, so that the right hand term in (5) is
larger than ̟k. As αi and α

′

i are less than n − i − 1, the left hand term is less than ̟k − 1
by (3), a contradiction. The uniqueness of the decomposition also holds in Zn!.

4


 
 page_ended 
 
Arithmetics can be performed in the ring (Zn!, +,×) endowed with the ̟-system. The
computation of the sum and product works in the usual way of positional number systems,
using the ring structure of Zn−i for the operations on the digits of the operands. There is
no carry to propagate after the leftmost digit.

Lemma 3. The base elements verify

̟n,i+k = ̟n−k,i̟n,k, (6)

k−1
∑

i=0

(n − i − 1)̟n,i = ̟n,k − 1, k ∈ {1, . . . n − 2}, (7)

n−2
∑

i=0

(n − i − 1)̟n,i = −1. (8)

Proof. The verification of the first relation is straightforward. The identities (3) written in
Zn! give (7) and (8). For (8), we use the fact that n! − 1 = −1 in Zn!.

Corollary 4. For α, α′ ∈ Zn!, with digits αi, α
′

i ∈ Zn−i,

α + α′ = −1 ⇐⇒ αi + α
′

i = −1, i = 0, . . . , n − 2.

Proof. We write

α + α′ =
n−2
∑

i=0

(αi + α
′

i)̟n,i.

In Zn−i, αi+α
′

i = −1 if and only if αi+α
′

i = n−i−1. By the uniqueness of the decomposition
in the ̟-system, the result follows from (8).

3 Code

The set of permutations on n symbols x1, . . . , xn is denoted Sn. From a permutation q on
the n − 1 symbols x1, . . . , xn−1, n permutations on n symbols are generated by inserting xn
to the right and permuting the symbols cyclically. The insertion of xn to the right defines
an injection

Sn−1
ι

−→ Sn
q = (a1 · · · an−1) 7−→ (a1 · · · an−1xn) = q̃.

We define the cyclic shift S : Sn−1 → Sn by S = Cι, where C : Sn → Sn is the circular
permutation, so that

S0q = (a1a2 · · · an−1xn) = C
0q̃ = q̃,

S1q = (a2 · · · an−1xna1) = C
1q̃,

...

Sn−1q = (xna1a2 · · · an−1) = C
n−1q̃.

The set O(q) = {S0q, . . . , Sn−1q} is the orbit of q. As Si = Sj is equivalent to i = j mod n,
the exponents of the cyclic shift are elements of Zn.

5


 
 page_ended 
 
Lemma 5. The set of permutations Sn is the disjoint union of the orbits O(q) for q ∈ Sn−1.

Proof. If q, r ∈ Sn−1, their orbits are disjoint subsets of Sn. Indeed, if S
iq = Sjr, there exists

k ∈ Zn such that S
kq = S0r = r̃. The only possibility is k = 0, implying S0q = q̃ = r̃, and

q = r. There are (n − 1)! disjoint orbits, each of size n, so that they span Sn.

According to Lemma 5, the set Sn can be generated by cyclic shift. The generation by
cyclic shift defines an order on the set of permutations, Sn = {p0, . . . , pn!−1}, a cyclic order
in fact. For this order, the rank α of a permutation pα ∈ Sn is an element of Zn!.

The generation by cyclic shift of p ∈ Sn from (1) ∈ S1 can be schematized:







p(1) = (1)
αn−2
−→ p(2) −→ · · ·

α2
−→ p(n−2)

α1
−→ p(n−1)

α0
−→ p(n) = p,

p(n−i) = Sαin−ip
(n−i−1),







(9)

where p(n−i) ∈ Sn−i is generated from p
(n−i−1) ∈ Sn−i−1 by the cyclic shift

Sn−i : Sn−i−1 −→ Sn−i

with the exponent αi ∈ Zn−i (Example 1).

Definition 6. The sequence of exponents αi ∈ Zn−i associated with successive cyclic
shifts leading from (1) ∈ S1 to p ∈ Sn is the code of p in the ̟-system:

α = αn−2 · · ·α0̟ ∈ Zn!.

Theorem 7. The rank of a permutation on n symbols generated by cyclic shift is given by
its code. A permutation on n symbols generated by cyclic shift is determined by writing its
rank in the ̟-system.

Proof. We use induction on n. For n = 2, in S2 = {(12), (21)}, the rank of the permutation
(12) is 0 = 0̟, and the rank of the permutation (21) is 1 = 1̟. For n &gt; 2, let p = pα ∈ Sn
of rank α, generated by cyclic shift from q = qβ ∈ Sn−1 of rank β. Then p = S

α0
n q for some

α0 ∈ Zn, α0 being the rank of p within the orbit of q. As the orbits contain n elements and
as β is the rank of q in Sn−1, the rank of p in Sn is

α = βn + α0 = β̟n,1 + α0̟n,0.

By induction hypothesis, the rank β of q is given by the code

β =
n−3
∑

i=0

βi̟n−1,i, βi ∈ Zn−1−i.

Eq. (6) gives, for k = 1,
̟n,i+1 = ̟n−1,i̟n,1,

so that

β̟n,1 =
n−3
∑

i=0

βi̟n−1,i̟n,1 =
n−3
∑

i=0

βi̟n,i+1 =
n−2
∑

i=1

βi−1̟n,i.

6


 
 page_ended 
 
Let αi = βi−1 for i = 1, . . . , n − 2. As βi ∈ Zn−1−i, αi ∈ Zn−i. We obtain that

α = β̟n,1 + α0̟n,0 =
n−2
∑

i=0

αi̟n,i, αi ∈ Zn−i,

is the code of pα. Conversely, let pα ∈ Sn. We write the rank α in the ̟-system, α =
αn−2 · · ·α0̟, and use scheme (9) with the exponents αn−2, . . . , α0 to determine pα.

α p
α

α2 α1 α0
0 1234 0 0 0

1 2341 0 0 1

2 3412 0 0 2

3 4123 0 0 3

4 2314 0 1 0

5 3142 0 1 1

6 1423 0 1 2

7 4231 0 1 3

8 3124 0 2 0

9 1243 0 2 1

10 2431 0 2 2

11 4312 0 2 3

12 2134 1 0 0

13 1342 1 0 1

14 3421 1 0 2

15 4213 1 0 3

16 1324 1 1 0

17 3241 1 1 1

18 2413 1 1 2

19 4132 1 1 3

20 3214 1 2 0

21 2143 1 2 1

22 1432 1 2 2

23 4321 1 2 3

Table 1: The codes of the permutations of {1, 2, 3, 4} generated by cyclic shift.

Algorithm C in Knuth [1, §7.2.1.2] generates Sn by cyclic shift in a simple version of the
scheme described in this section.

In the sequel, we assume that Sn is ordered according to generation by cyclic shift.

4 k-orbits

The ̟-system is a family of number systems indexed by n, which are compatible in a sense
precised in the next proposition. The compatibility relies on relation (6).

Proposition 8. Let k ∈ {0, . . . , n − 2} and pα ∈ Sn with code α ∈ Zn!. There exists a
permutation qβ ∈ Sn−k with code β ∈ Z(n−k)! such that

α = β̟n,k + γ, γ ∈ {0, . . . , ̟n,k − 1}. (10)

7


 
 page_ended 
 
The code β is made of the n − k − 1 leftmost digits of α, and γ is made of the k rightmost
digits of α.

Proof. We have the decomposition

α = αn−2 · · ·α0̟ = αn−2 · · ·αk0 · · · 0̟ + 0 · · · 0αk−1 · · ·α0̟ = α̃ + γ.

Let βi = αi+k for i = 0, . . . , n − k − 2, so that the β’s are the n − k − 1 leftmost digits of α.
As αi ∈ Zn−i, βi = αi+k ∈ Zn−k−i. Hence

β =
n−k−2
∑

i=0

βi̟n−k,i, βi ∈ Zn−k−i,

is an element of Z(n−k)! which is the code of a permutation qβ ∈ Sn−k. Using relation (6),
we obtain

α̃ =
n−2
∑

i=k

αi̟n,i =
n−k−2
∑

i=0

αi+k̟n,i+k =
n−k−2
∑

i=0

αi+k̟n−k,i̟n,k =

(

n−k−2
∑

i=0

βi̟n−k,i

)

̟n,k.

The term

γ =
k−1
∑

i=0

αi̟n,i

is made of the k rightmost digits of α. It is an element of Zn−k+1 × · · · × Zn ranging from 0
to
∑k−1

i=0 (n − i − 1)̟n,i, which equals ̟n,k − 1 by (7). We obtain

α = α̃ + γ = β̟n,k + γ.

Definition 9. For k ∈ {0, . . . , n − 2} and qβ ∈ Sn−k, the k-orbit of qβ is the following
subset of Sn:

On,k(qβ) = {pα ∈ Sn; α = β̟n,k + γ, γ = 0, . . . , ̟n,k − 1}.

For k = 0, the 0-orbit of q ∈ Sn is {q}. Indeed, for k = 0, ̟n,0 = 1, γ = 0, and q = pα.
For k ≥ 1, a k-orbit On,k(q) can be described as the subset of Sn generated from q ∈ Sn−k by
k successive cyclic shifts. Indeed, by Proposition 8, the code of pα ∈ On,k(qβ) is obtained by
appending αk−1 · · ·α0 to the code βn−k−2 · · · β0̟ of qβ. By scheme (9), the digits αk−1, . . . , α0
describe the generation of pα from qβ. In particular, for k = 1, the 1-orbit On,1(q) of q ∈ Sn−1
is the orbit O(q). We may further define the (n − 1)-orbit On,n−1(q) as the whole set Sn,
with q = (1) ∈ S1.

We have the following generalization of Lemma 5:

Proposition 10. For k ∈ {0, . . . , n− 2}, the set of permutations Sn is the disjoint union of
the k-orbits On,k(q) for q ∈ Sn−k.

8


 
 page_ended 
 
Proof. The k-orbits are disjoint by the uniqueness of the decomposition (10). They are
(n− k)! in number, and contain ̟n,k elements each. As (n− k)!̟n,k = n! in N, the k-orbits
span Sn.

In decomposition (10), β specifies to which k-orbit pα belongs and γ specifies the rank of
pα within the k-orbit. The first element of the k-orbit has rank α

first = β̟n,k (i.e., γ = 0).
The last element has rank αlast = β̟n,k + ̟n,k − 1 (i.e., γ = ̟n,k − 1). The element next to
the last has rank αlast + 1 = β̟n,k + ̟n,k = (β + 1)̟n,k. It is the first element of the next
k-orbit On,k(qβ+1), where qβ+1 is the element next to qβ in Sn−k.

Lemma 11. Let pα ∈ Sn. There exists a largest k ∈ {0, . . . , n− 2} and qβ ∈ Sn−k such that
pα is the last element of the k-orbit On,k(qβ), and not the last element of the (k + 1)-orbit
containing this k-orbit.

Proof. If pα is not the last element of the 1-orbit it belongs to, it is the last element of the
0-orbit {pα}. In this trivial case, k = 0 and pα = qβ. Otherwise the rightmost digit of α is
α0 = n − 1. There exists a largest k ≥ 1 such that αi = n − i − 1 for i = 0, . . . , k − 1, and
αk 6= n − k − 1. This means that pα is the last element of nested j-orbits, j = 1, . . . , k, and
not the last element of the (k + 1)-orbit containing these nested j-orbits.

5 Symmetries

For compatibility with the cyclic shift, we adopt the convention that the positions of the
symbols in a permutation are computed from the right, and are considered as elements of
Zn (the position of the last symbol is 0 and the position of the first symbol is n − 1).

According to scheme (9), the symbol xn−i (i ≥ 2) appears at step n− i with the digit αi
as exponent of the cyclic shift. Its position in the generated permutation p(n−i) is therefore

posn−i(xn−i, p
(n−i)) = αi.

In particular,
posn(xn, p

(n)) = α0. (11)

For a permutation p = (a1a2 · · · an−1an) ∈ Sn, we introduce the mirror image of p,
p = (anan−1 · · · a2a1).

Proposition 12. The permutations pα and pα′ are the mirror image of one another if and
only if their ranks α and α′ verify in Zn!

α + α′ = −1.

For example, in Z5! we have 84 + 35 = −1, and in S5, p84 = (51324) is the mirror image
of p35 = (42315).

Proof. The proof is by induction on n. For n = 2, p0 = (12), p1 = (21), and 0 + 1 = 1 = −1
in Z2. Let n &gt; 2. By Proposition 8,

α = β̟n,1 + α0̟n,0, α
′ = β′̟n,1 + α

′

0̟n,0, qβ, qβ′ ∈ Sn−1, α0, α
′

0 ∈ Zn.

9


 
 page_ended 
 
By Corollary 4, the condition α + α′ = −1 is equivalent to β + β′ = −1 and α0 + α
′

0 = −1.
By induction hypothesis, qβ is the mirror image of qβ′ in Sn−1 if and only if β + β

′ = −1.
The condition α + α′0 = −1 is equivalent to α

′

0 = n− 1− α0, i.e., the ranks of α0 and α
′

0 are
symmetrical in Zn. By (11), these ranks are the positions of symbol xn when pα and pα′ are
generated by cyclic shift from qβ and qβ′ respectively. This gives the result.

Corollary 13. The word constructed by concatenating the symbols of the permutations gen-

erated by cyclic shift is a palindrome.

Proof. Let pα ∈ Sn. The rank symmetrical to α in Zn! is (n! − 1) − α = −(α + 1). By
Proposition 12, p−(α+1) is the mirror image of pα.

The set Sn has in fact deeper symmetries, coming from the recursive structure of the
k-orbits.

According to Theorem 7, the generation of Sn by cyclic shift is obtained by performing
α → α + 1 for α ∈ Zn!, and writing α in the ̟-system. This determines each permutation
pα. For a fixed k, as α runs through Zn!, pα runs through the k-orbits of Sn, and leaves a
k-orbit to enter the next when, in the computation of α + 1, the carry propagates up to the
digit αk, incrementing the rank β of the k-orbit.

Proposition 14. Any two successive permutations of Sn are written as

pα = AB, pα+1 = BA,

with an integer k ∈ {0, . . . , n − 2} such that

|A| = k + 1.

For example, in S5, p39 = (54231) and p40 = (31245).

Proof. If pα and pα+1 are in the same 1-orbit then

pα = (a1a2 · · · an), pα+1 = (a2 · · · ana1).

The result holds with A = (a1), B = (a2 · · · an), and this corresponds to k = 0. Otherwise,
by Lemma 11, there exists a largest k ≥ 1 such that pα is the last element of a k-orbit, and
not the last element of a (k+1)-orbit. The elements of a k-orbit are generated by successively
inserting the symbols xn−k+1, . . . , xn from a permutation qβ ∈ Sn−k. The last element is

(xn · · ·xn−k+1b1 · · · bn−k),

where qβ = (b1 · · · bn−k) is a permutation of the symbols x1, . . . , xn−k. The first element of
the next k-orbit is

(c1 · · · cn−kxn−k+1 · · ·xn),

where qβ+1 = (c1 · · · cn−k). As Sn−k is generated by cyclic shift, qβ+1 = Cn−kqβ, with Cn−k
the circular permutation in Sn−k. We obtain

pα = (xn · · ·xn−k+1b1b2 · · · bn−k) = AB
pα+1 = (b2 · · · bn−kb1xn−k+1 · · ·xn) = BA,

where A = (b1xn−k+1 · · ·xn) contains k + 1 symbols.

10


 
 page_ended 
 
According to Proposition 14, k + 1 symbols (the symbols of A) have to be erased to the
left of pα so that the last symbols of pα (the symbols of B) match the first symbols of pα+1.

Definition 15. The weight en(α) of the transition α → α + 1 is the number of symbols
that have to be erased to the left of pα so that the last symbols of pα match the first symbols
of pα+1. The ̟-ruler sequence is the sequence of weights:

En = {en(α); α = 0, . . . , n! − 2}.

Proposition 16. The ̟-ruler sequence is a palindrome.

Proof. If the ranks α and α′ are symmetrical in Zn!, α + α
′ = −1. Then αi + α

′

i = −1 for
i = 0, . . . , n − 2 by Corollary 4. By the definition of en(α) (the weight associated with the
transition α → α + 1), we want to show that en(α) = en(α

′ − 1). If pα is the last element of
a k-orbit, k ≥ 1, then αi = −1 for i = 0, . . . , k − 1, so that α

′

i = 0 for i = 0, . . . , k − 1: pα′
is the first element of a k-orbit, and pα′−1 is the last element of the previous k-orbit. Hence
en(α) = en(α

′ − 1) = k + 1. If pα is not the last element of a k-orbit, then α0 6= −1. Hence
α′0 6= 0, and pα′ is not the first element of a 1-orbit. In this case en(α) = en(α

′ − 1) = 1.

Proposition 17. The number of terms of the ̟-ruler sequence such that en(α) = k is

(n − k)(n − k)!.

The sum of its n! − 1 terms is

Wn = 1! + 2! + . . . + n! − n.

Proof. We have en(α) = k if and only if pα is the last element of a (k − 1)-orbit, and not
the last element of a k-orbit. The number of (k − 1)-orbits within a k-orbit is n − k + 1.
We exclude the last (k − 1)-orbit within the k-orbit (otherwise pα would be the last element
of the k-orbit). This gives n − k possibilities for en(α) = k in a k-orbit. As the number of
k-orbits is (n − k)!, there are (n − k)(n − k)! possibilities for en(α) = k.

The formula for the sum is shown by induction. We have W2 = 1 = 1! + 2! − 2, and for
n &gt; 2,

Wn =
n−1
∑

k=1

k(n − k)(n − k)! =
n−2
∑

k=0

(k + 1)(n − 1 − k)(n − 1 − k)!

=
n−2
∑

k=1

k(n − 1 − k)(n − 1 − k)! +
n−2
∑

k=0

(n − 1 − k)(n − 1 − k)!

= Wn−1 +
n−1
∑

i=1

i · i! = 1! + . . . + (n − 1)! − (n − 1) + n! − 1 = 1! + . . . + n! − n.

In the last line, the induction hypothesis and identity (1) have been used.

The ̟-ruler sequence is analogous to the binary ruler function (A001511 in Sloane [3]).
The terms of the ruler function give the position of the bit to flip when the binary numbers
are listed according to the binary reflected Gray code. They represent the binary division
of an inch. The ̟-ruler sequence differs in that the number of intermediate ticks increases
with n (Table 2).

11

<div class="annotation"><a href="http://www.research.att.com/cgi-bin/access.cgi/as/~njas/sequences/eisA.cgi?Anum=A001511">http://www.research.att.com/cgi-bin/access.cgi/as/~njas/sequences/eisA.cgi?Anum=A001511</a>

 
 page_ended 
 
n E
n

2 1

3 12212

4 13213213313213213

5 14214214214314214214214314214214214414214214214314214214214314214214214

Table 2: The ̟-ruler sequence for n = 2, 3, 4, 5 (1j denotes 1 repeated j times).

6 Combinatorial Gray code

A combinatorial Gray code is a method for generating combinatorial objects so that suc-
cessive objects differ by some pre-specified adjacency rule involving a minimality criterion
(Savage [4]). Such a code can be formulated as an Hamiltonian path or cycle in a graph
whose vertices are the combinatorial objects to be generated. Two vertices are joined by an
edge if they differ from each other in the pre-specified way.

The code associated with the ̟-system corresponds to an Hamiltonian path in a weighted
directed graph Gn.

Definition 18. The vertices of the digraph Gn are the elements of Sn. For two permuta-
tions (vertices) pα and pα′ , there is an arc from pα to pα′ if and only if the last symbols of pα
match the first symbols of pα′ (there is no arc when there is no match). Let pα, pα′ ∈ Sn be
two connected vertices in Gn. The weight fn(α, α

′) ∈ {1, . . . , n − 1} associated with the arc
(pα, pα′) is the number of symbols that have to be erased to the left of pα so that the last
symbols of pα match the first symbols of pα′ .

By Proposition 14, for each α, there is an arc of weight en(α) = fn(α, α + 1) joining pα
to pα+1. This allows to define the Hamiltonian path

wn = {(pα, pα+1); α = 0, . . . , n! − 2}

joining successive permutations. This path has total weight Wn = 1! + · · · + n! − n by
Proposition 17. The path wn can be closed into an Hamiltonian cycle by joining the last
permutation pn!−1 to the first p0 by an arc of weight n − 1:

(xn · · ·x2x1)
n−1
−−→ (x1x2 · · ·xn).

Hence, an oriented path exists from any vertex to any other, so that Gn is strongly connected.
Table 3 displays the adjacency matrix of the weighted digraph G4 and the Hamiltonian

path w4.

Proposition 19. Each vertex of Gn has exactly j! in-arcs of weight j and j! out-arcs of
weight j for j = 1, . . . , n − 1. Hence the vertices of Gn have L = 1! + · · · + (n − 1)! as in-
and out-degree, and Gn is L-regular. The total number of arcs is Ln!.

Proof. Let us consider the arcs of weight j ∈ {1, . . . , n − 1} joining a vertex to another in
Gn:

(a1 · · · ajb1 · · · bn−j)
j
−→ (b1 · · · bn−jc1 · · · cj),

12


 
 page_ended 
 
0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
0 0 1 2 3 0 0 0 3 0 0 0 3 0 0 2 3 0 0 0 3 0 0 0 3
1 3 0 1 2 0 0 3 0 0 3 0 0 0 3 0 0 3 0 0 2 0 0 3 0
2 2 3 0 1 3 0 0 0 0 2 3 0 3 0 0 0 0 0 3 0 0 3 0 0
3 1 2 3 0 2 3 0 0 3 0 0 0 0 0 3 0 0 3 0 0 3 0 0 0
4 0 0 0 3 0 1 2 3 0 0 0 3 0 0 0 3 0 0 0 3 0 0 2 3
5 0 3 0 0 3 0 1 2 0 0 3 0 3 0 0 2 0 0 3 0 0 3 0 0
6 0 2 3 0 2 3 0 1 3 0 0 0 0 0 3 0 0 3 0 0 3 0 0 0
7 3 0 0 0 1 2 3 0 2 3 0 0 0 3 0 0 3 0 0 0 0 0 3 0
8 0 0 0 3 0 0 0 3 0 1 2 3 0 0 0 3 0 0 2 3 0 0 0 3
9 0 0 3 0 0 3 0 0 3 0 1 2 0 0 3 0 0 3 0 0 3 0 0 2
10 3 0 0 0 0 2 3 0 2 3 0 1 0 3 0 0 3 0 0 0 0 0 3 0
11 2 3 0 0 3 0 0 0 1 2 3 0 3 0 0 0 0 0 3 0 0 3 0 0

12 0 0 2 3 0 0 0 3 0 0 0 3 0 1 2 3 0 0 0 3 0 0 0 3
13 0 3 0 0 3 0 0 2 0 0 3 0 3 0 1 2 0 0 3 0 0 3 0 0
14 3 0 0 0 0 0 3 0 0 3 0 0 2 3 0 1 3 0 0 0 0 2 3 0
15 0 0 3 0 0 3 0 0 3 0 0 0 1 2 3 0 2 3 0 0 3 0 0 0
16 0 0 0 3 0 0 0 3 0 0 2 3 0 0 0 3 0 1 2 3 0 0 0 3
17 3 0 0 2 0 0 3 0 0 3 0 0 0 3 0 0 3 0 1 2 0 0 3 0
18 0 0 3 0 0 3 0 0 3 0 0 0 0 2 3 0 2 3 0 1 3 0 0 0
19 0 3 0 0 3 0 0 0 0 0 3 0 3 0 0 0 1 2 3 0 2 3 0 0
20 0 0 0 3 0 0 2 3 0 0 0 3 0 0 0 3 0 0 0 3 0 1 2 3
21 0 0 3 0 0 3 0 0 3 0 0 2 0 0 3 0 0 3 0 0 3 0 1 2
22 0 3 0 0 3 0 0 0 0 0 3 0 3 0 0 0 0 2 3 0 2 3 0 1
23 3 0 0 0 0 0 3 0 0 3 0 0 2 3 0 0 3 0 0 0 1 2 3 0

Table 3: The adjacency matrix of the digraph G4. Lines delineate the 1-orbits. Double lines
delineate the 2-orbits. Entries on the upper diagonal (in color) indicate the Hamiltonian
path corresponding to the ̟-system code, and forming the ̟-ruler sequence.

where the c’s are a permutation of the a’s. There are j! possibilities for the c’s, the a’s
and the b’s being fixed. Hence j! arcs of weight j leave each vertex. Similarly, there are
j! possibilities for the a’s, the b’s and the c’s being fixed, so that j! arcs of weight j enter
each vertex. By the degree sum formula, the sum of the in- or out-degrees of the n! vertices,
n!(1! + · · · + (n − 1)!), equals the total number of arcs.

The set {Gn; n ≥ 1} is an infinite family of strongly connected regular digraphs.

We conjecture that the Hamiltonian path wn joining successive permutations in the di-
graph Gn is of minimal total weight. Assuming the conjecture, we may state:

The ̟-system is a combinatorial Gray code listing the permutations generated by cyclic
shift. The adjacency rule is that the minimal number of symbols is erased to the left of a

permutation so that the last symbols of the permutation match the first symbols of the next

permutation.

7 Acknowledgments

Marco Castera initiated the problem which motivated this study. The pertinent comments
of the anonymous referee were very helpful.

13


 
 page_ended 
 
References

[1] D. E. Knuth, The Art of Computer Programming, Vol. 4, Combinatorial Algorithms,
Addison-Wesley, 2005.

[2] C.-A. Laisant, Sur la numération factorielle, application aux permutations, Bull. Soc.
Math. France 16 (1888), 176–183.

[3] N. J. A. Sloane, The On–Line Encyclopedia of Integer Sequences, published electroni-
cally at http://www.research.att.com/~njas/sequences, 2010.

[4] C. Savage, A survey of combinatorial Gray codes, SIAM Rev. 39 (1997), 605–629.

2000 Mathematics Subject Classification: Primary 05A05, 11A63; Secondary 05C20, 05C38.
Keywords : permutations, cyclic shift, number system, palindrome, combinatorial Gray code.

(Concerned with sequences A000142, A001511, A007489, and A033312.)

Received September 21 2010; revised version received December 13 2010; February 14 2011.
Published in Journal of Integer Sequences, March 25 2011.

Return to Journal of Integer Sequences home page.

14

<div class="annotation"><a href="http://www.research.att.com/~njas/sequences">http://www.research.att.com/~njas/sequences</a>
<div class="annotation"><a href="http://www.research.att.com/cgi-bin/access.cgi/as/~njas/sequences/eisA.cgi?Anum=A000142">http://www.research.att.com/cgi-bin/access.cgi/as/~njas/sequences/eisA.cgi?Anum=A000142</a>
<div class="annotation"><a href="http://www.research.att.com/cgi-bin/access.cgi/as/~njas/sequences/eisA.cgi?Anum=A001511">http://www.research.att.com/cgi-bin/access.cgi/as/~njas/sequences/eisA.cgi?Anum=A001511</a>
<div class="annotation"><a href="http://www.research.att.com/cgi-bin/access.cgi/as/~njas/sequences/eisA.cgi?Anum=A007489">http://www.research.att.com/cgi-bin/access.cgi/as/~njas/sequences/eisA.cgi?Anum=A007489</a>
<div class="annotation"><a href="http://www.research.att.com/cgi-bin/access.cgi/as/~njas/sequences/eisA.cgi?Anum=A033312">http://www.research.att.com/cgi-bin/access.cgi/as/~njas/sequences/eisA.cgi?Anum=A033312</a>
<div class="annotation"><a href="http://www.cs.uwaterloo.ca/journals/JIS/">http://www.cs.uwaterloo.ca/journals/JIS/</a>

<ul>	<li>Introduction</li>
	<li>Number system</li>
	<li>Code</li>
	<li>k-orbits</li>
	<li>Symmetries</li>
	<li>Combinatorial Gray code</li>
	<li>Acknowledgments</li>
</ul>
 
 page_ended 
 